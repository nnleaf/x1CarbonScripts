#!/bin/bash
#     ////     //  ////     //
#    // //    //  // //    //
#   //  //   //  //  //   //
#  //   //  //  //   //  //
# //    // //  //    // //
#//     ////  //     ////
#=============
#//CHANGELOG//
#=============
#v0.1 - 20200320 - Initial maintenance script created
#                - Used Arch wiki as base - https://wiki.archlinux.org/index.php/System_maintenance
#v0.2 - 20200323 - First script for updating Arch
#v1.0 - 20200402 - Combined update and maintenance scripts
#
echo "------------------------------------------------------------------------"
echo "Updating Arch..."
echo "------------------------------------------------------------------------"
sudo pacman -Syu
echo "------------------------------------------------------------------------"
echo "Upgrading Arch AUR..."
echo "------------------------------------------------------------------------"
yay -Syu --aur
echo "------------------------------------------------------------------------"
echo "Remember to check logs!"
echo "------------------------------------------------------------------------"
read -p "Check logs? (y/n)"
echo
if [[ $REPLY =~ ^[Yy]$ ]]
then
  echo "------------------------------------------------------------------------"
  echo "Check SMART reading on NVME drive..."
  echo "------------------------------------------------------------------------"
  sudo smartctl -a /dev/nvme0n1p1
  echo "------------------------------------------------------------------------"
  echo "Check TLP battery stats..."
  echo "------------------------------------------------------------------------"
  sudo tlp-stat -b
  echo "------------------------------------------------------------------------"
  echo "Clean unused dependencies..."
  echo "------------------------------------------------------------------------"
  sudo yay -Yc
  echo "------------------------------------------------------------------------"
  echo "Updating locate database..."
  echo "------------------------------------------------------------------------"
  sudo updatedb
  echo "------------------------------------------------------------------------"
  echo "Check if any systemd services have entered a failed state"
  echo "------------------------------------------------------------------------"
  sudo systemctl --failed
fi
