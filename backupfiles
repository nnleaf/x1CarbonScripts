#!/bin/bash
#     ////     //  ////     //
#    // //    //  // //    //
#   //  //   //  //  //   //
#  //   //  //  //   //  //
# //    // //  //    // //
#//     ////  //     ////
#=============
#//CHANGELOG//
#=============
#v0.1 - 20200413 - Created backupfiles script to backup linux files to vault
echo "----------------------"
echo "--[ Mounting Vault ]--"
echo "----------------------"
sudo mount -t cifs //192.168.1.111/n1 /mnt/tmp -o credentials=/home/nn/Keys/.vaultpassword
echo "----------------------------------------------------"
echo "--[ 1:1 Backup Documents and Linux files dry-run ]--"
echo "----------------------------------------------------"
sudo rsync -avnh --progress --delete --stats --ignore-existing --ignore-errors -s -e "ssh" --rsync-path="sudo rsync" /home/nn/Documents/ /mnt/tmp/Files/Documents/
sudo rsync -avnh --progress --delete --stats --ignore-existing --ignore-errors -s -e "ssh" --rsync-path="sudo rsync" /home/nn/Linux/ --exclude={'Debian/Archive','Arch/Archive'} /mnt/tmp/Files/ComputerFiles/Linux/ 
read -p "Run real backup to vault? (y/n)"
echo
if [[ $REPLY =~ ^[Yy]$ ]]
then
  echo "--------------------------"
  echo "--[ Backing up Keepass ]--"
  echo "--------------------------"
  cp -r /home/nn/Keys/ /home/nn/Documents/Keepass/Key/key_"$(date +%Y-%m-%d_%H%M%S)"/
  cp -r /home/nn/Dropbox/Key/ /home/nn/Documents/Keepass/Database/database_"$(date +%Y-%m-%d_%H%M%S)"/
  echo "-------------------------"
  echo "--[ Backing up Resume ]--"
  echo "-------------------------"
  cp -r /home/nn/Dropbox/Resume/ /home/nn/Documents/Resume/resume_"$(date +%Y-%m-%d_%H%M%S)"/
  echo "---------------------------------------------------------"
  echo "--[ 1:1 Backing up Documents and Linux files to vault ]--"
  echo "---------------------------------------------------------"
  sudo rsync -avh --progress --delete --stats --ignore-existing --ignore-errors -s -e "ssh" --rsync-path="sudo rsync" /home/nn/Documents/ /mnt/tmp/Files/Documents/
  sudo rsync -avh --progress --delete --stats --ignore-existing --ignore-errors -s -e "ssh" --rsync-path="sudo rsync" /home/nn/Linux/ --exclude={'Debian/Archive','Arch/Archive'} /mnt/tmp/Files/ComputerFiles/Linux/ 
  sudo umount -t cifs //192.168.1.111/n1
fi
